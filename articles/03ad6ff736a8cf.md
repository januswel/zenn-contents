---
title: "Custom Hooks as Presenter ã¨ã„ã†è€ƒãˆæ–¹"
emoji: "ğŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["react", "cleanarchitecture", "test", "unittest"]
published: false
---

# TL;DR

```typescript
function usePresenter(props: Props) {}
function MyComponent(props: Props) {}
```

# è§£æ±ºã—ãŸã„èª²é¡Œ

æ¥µåŠ›ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®åŠ´åŠ›ã‚’ã‹ã‘ãšã€ React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã‚’æ„å‘³ã‚ã‚‹ã‚‚ã®ã¨ã—ãŸã„ã€‚ã“ã‚ŒãŒã€ã¾ã•ã«è§£æ±ºã—ãŸã„èª²é¡Œã ã€‚

ã“ã“ã§ã¯ React Hooks ã‚’ç”¨ã„ã¦å®Ÿè£…ã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å¯¾è±¡ã¨ã—ã¦ã„ã‚‹ã€‚

## ç¾çŠ¶æ•´ç†

React Hooks ãŒå°å…¥ã•ã‚Œã¦ä»¥é™ã€è¤‡é›‘ãªå‡¦ç†ã‚’é–¢æ•°å‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§å®Ÿè£…ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã€ React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè‡ªä½“ã®è¤‡é›‘æ€§ãŒä¸ŠãŒã£ã¦ã„ã‚‹ã€‚

ã¾ãŸã€ç¾åœ¨ React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆæ‰‹æ³•ã¯æ§˜ã€…ãªã‚‚ã®ãŒææ¡ˆã•ã‚Œã¦ã„ã‚‹ã€‚

- ä»®æƒ³ DOM ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ
- ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°
- ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°

## Hooks å°å…¥ã«ã‚ˆã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¤‡é›‘æ€§å¢—åŠ 

Hooks ãŒå°å…¥ã•ã‚ŒãŸ React v16.18.0 ä»¥é™ã€è¡¨ç¤ºã¨ãƒ­ã‚¸ãƒƒã‚¯ãŒå¯†çµåˆã«ãªã‚ŠãŒã¡ã ã€‚[å…¬å¼ã®ä¾‹ã«ãŠã„ã¦ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…éƒ¨ã«ãƒ­ã‚¸ãƒƒã‚¯ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ãŒç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹](https://ja.react.dev/blog/2023/03/16/introducing-react-dev#going-all-in-on-modern-react-with-hooks)ã“ã¨ã‚‚ã‚ã‚Šã€ãã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’è€ƒãˆã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãªãçœŸä¼¼ã‚’ã—ã¦ã—ã¾ã†ã“ã¨ã‚‚ã‚ã‚‹ã ã‚ã†ã€‚

### ä»®æƒ³ DOM ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ

[ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚ŒãŸä»®æƒ³ DOM ã«å¯¾ã—ã¦ã€ç‰¹å®šã®è¦ç´ ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒ†ã‚¹ãƒˆ](https://testing-library.com/docs/queries/about)ã¯æ©Ÿèƒ½ã™ã‚‹ã“ã¨ãŒã‚ã‚‹ãŒã€ DOM è‡ªä½“ãŒå¤‰æ›´ã•ã‚Œã‚„ã™ã„ãŸã‚ãƒ†ã‚¹ãƒˆã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒé«˜ãã¤ãã€‚

ã¾ãŸã€æ„å‘³ã®ã‚ã‚‹ãƒ†ã‚¹ãƒˆã¨ã™ã‚‹ãŸã‚ã«è¤‡æ•°ã®è¦ç´ ã‚’ãƒã‚§ãƒƒã‚¯ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã“ã¨ãŒå¤šãã€ãƒ†ã‚¹ãƒˆã®æ•°ãŒå¤šããªã‚ŠãŒã¡ã ã€‚

### ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚° / ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°

[ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°](https://jestjs.io/ja/docs/snapshot-testing)ã‚„[ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ](https://github.com/reg-viz/reg-suit)ã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æ„å›³ã—ãªã„å·®åˆ†ãŒç”Ÿã˜ãŸã“ã¨ã‚’æ¤œçŸ¥ã§ãã‚‹ã€‚

ãŒã€ React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒãƒ­ã‚¸ãƒƒã‚¯ã‚’æŒã¤å ´åˆã€è¤‡é›‘ãªãƒ†ã‚¹ãƒˆã«ãªã£ã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ã¾ãŸã€å¤‰æ›´ãŒæ„å›³çš„ã‹ã©ã†ã‹ã‚’åˆ¤åˆ¥ã™ã‚‹ãŸã‚ã«ã€äººé–“ãŒãƒ†ã‚¹ãƒˆçµæœã‚’è¦‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚

## ãƒ†ã‚¹ãƒˆã®ç›®çš„

ã•ã¦ã€å…·ä½“çš„ã«è‡ªåˆ†ãŒä½•ã«å›°ã£ã¦ã„ã‚‹ã‹ã¨ã„ã†ã¨ã€æ¬¡ã®è¦³ç‚¹ã‚’æ‹…ä¿ã—ãŸãƒ†ã‚¹ãƒˆã‚’æ›¸ãã®ãŒé›£ã—ã„ã¨ã„ã†ã“ã¨ã ã€‚

1. Bug Repellent: ãƒã‚°é¿ã‘
   - è¤‡é›‘æ€§ãŒé«˜ããªã‚ŠãŒã¡ã®ãŸã‚ãƒã‚°ç™ºç”Ÿã®å¯èƒ½æ€§ãŒé«˜ããªã£ã¦ã„ã‚‹
2. Defect Localization: æ¬ é™¥ã®ç‰¹å®š
   - è¡¨ç¤ºã¨ãƒ­ã‚¸ãƒƒã‚¯ã®ã©ã¡ã‚‰ã«ãƒã‚°ãŒã‚ã‚‹ã®ã‹ã€ãƒ­ã‚¸ãƒƒã‚¯ã®ã©ã“ãŒåŸå› ãªã®ã‹ã‚ã‹ã‚Šã¥ã‚‰ã„
3. Fully Automated Test: å®Œå…¨è‡ªå‹•åŒ–ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆ
   - ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãªã©ã¯æˆåŠŸã‹å¤±æ•—ã‹ã®åˆ¤æ–­ãŒå¿…è¦
4. Simple Tests: ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ†ã‚¹ãƒˆ
   - DOM ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆã¯ã‚·ãƒ³ãƒ—ãƒ«ã¨ãªã‚Šã¥ã‚‰ã„
5. Separation of Concerns: é–¢å¿ƒã®åˆ†é›¢
   - ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã¯ Hooks ã‚‚åŒæ™‚ã«ãƒ†ã‚¹ãƒˆå¯¾è±¡ã¨ã—ã¦ã—ã¾ã†
6. Robust Test: å¤‰æ›´ã«å¼·ã„ãƒ†ã‚¹ãƒˆ
   - è¡¨ç¤ºã¨ãƒ­ã‚¸ãƒƒã‚¯ã€ã©ã¡ã‚‰ãŒå¤‰ã‚ã£ã¦ã‚‚ãƒ†ã‚¹ãƒˆã‚’ä¿®æ­£ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„å¯èƒ½æ€§ãŒç”Ÿã˜ã‚‹

ã“ã‚Œã‚‰ã¯ xUnit Test Patterns ã«ãŠã„ã¦ã€ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆãŒç›®æŒ‡ã™ã¹ãã‚‚ã®ã¨ã—ã¦ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹æ¦‚å¿µã®ä¸€éƒ¨ã ã€‚

https://www.informit.com/store/xunit-test-patterns-refactoring-test-code-9780132800051

# Custom Hooks as Presenter

ã“ã®è¨˜äº‹ã«ãŠã‘ã‚‹é€ èªã§ã€å†’é ­ã§è¿°ã¹ãŸèª²é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã®ç³¸å£ã¨ãªã‚‹ã‚‚ã®ã ã€‚

## Presenter ã¨ã¯ä½•ã‹

ã‚«ã‚¿ã‚«ãƒŠã§æ›¸ãã¨ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã¨ãªã‚‹ã€‚ Clean Architecture ã«ãŠã‘ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ã²ã¨ã¤ã§ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‹ã‚‰å„ç¨®ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€ UI ãŒä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã™ã‚‹è²¬å‹™ã‚’æŒã¤ã€‚

![Clean Architecture æ¦‚è¦å›³](/images/custom-hooks-as-presenter/clean-architecture.png =400x)

> Presenter ã¯ã€ãƒ†ã‚¹ãƒˆå¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã¦ã€View ãŒç”»é¢ã«ç§»å‹•ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

:::message
Robert C.Martin; è§’å¾å…¸; é«˜æœ¨æ­£å¼˜. Clean Architecture é”äººã«å­¦ã¶ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æ§‹é€ ã¨è¨­è¨ˆ (ã‚¢ã‚¹ã‚­ãƒ¼ãƒ‰ãƒ¯ãƒ³ã‚´) . æ ªå¼ä¼šç¤¾ãƒ‰ãƒ¯ãƒ³ã‚´. Kindle ç‰ˆ. ç¬¬ 22 ç« ã‚ˆã‚Šå¼•ç”¨
:::

https://asciidwango.jp/post/176293765750/clean-architecture

React ã®æ–‡è„ˆã§ã¯ã€è¡¨ç¤ºç”¨ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¨˜è¿°ã—ãŸé–¢æ•°ã¨ã—ã¦ç†è§£ã™ã‚Œã°ã‚ˆã„ã ã‚ã†ã€‚

## Humble Object ã¨ Humble Dialog

ãã‚‚ãã‚‚ Clean Architecture ã§ã¯ã€ UI ã‚’ Humble Object ã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã¨è‰¯ã„ã¨æ›¸ã„ã¦ã‚ã‚‹ã€‚

> GUI ã®æŒ¯ã‚‹èˆã„ã®å¤§éƒ¨åˆ†ã¯ã€ç°¡å˜ã«ãƒ†ã‚¹ãƒˆã§ãã‚‹ã€‚Humble Object ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ãˆã°ã€2 ç¨®é¡ã®æŒ¯ã‚‹èˆã„ã‚’ Presenter ã¨ View ã® 2 ã¤ã®ã‚¯ãƒ©ã‚¹ã«åˆ†ã‘ã‚‰ã‚Œã‚‹ã€‚
> View ã¯ã€Humble Object ã§ã‚ã‚‹ã€‚ã“ã¡ã‚‰ã¯ãƒ†ã‚¹ãƒˆãŒé›£ã—ã„ã€‚ã—ãŸãŒã£ã¦ã€ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰ã¯ã§ãã‚‹ã ã‘ã‚·ãƒ³ãƒ—ãƒ«ã«ä¿ã£ã¦ãŠãã€‚GUI ã«ãƒ‡ãƒ¼ã‚¿ã‚’ç§»å‹•ã™ã‚‹ãŒã€ãã®ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã™ã‚‹ã“ã¨ã¯ãªã„ã€‚

:::message
Robert C.Martin; è§’å¾å…¸; é«˜æœ¨æ­£å¼˜. Clean Architecture é”äººã«å­¦ã¶ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æ§‹é€ ã¨è¨­è¨ˆ (ã‚¢ã‚¹ã‚­ãƒ¼ãƒ‰ãƒ¯ãƒ³ã‚´) . æ ªå¼ä¼šç¤¾ãƒ‰ãƒ¯ãƒ³ã‚´. Kindle ç‰ˆ. ç¬¬ 23 ç« ã‚ˆã‚Šå¼•ç”¨
:::

React ã®æ–‡è„ˆã«ãŠã‘ã‚‹ Humble Object ã¯ã„ã‚ã‚†ã‚‹ Dumb Component ã‚„ Presentational Component ã¨å‘¼ã°ã‚Œã¦ã„ã‚‹ã‚‚ã®ã«ç›¸å½“ã™ã‚‹ã€‚æ¬¡ã®ã‚ˆã†ãªã€ `props` ã®å€¤ã‚’ãã®ã¾ã¾è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã“ã¨ã ã€‚

```typescript
const DumbComponent: React.FC = (props: Props) => {
  return <Text>{props.name}</Text>;
};
```

ã“ã‚Œã¯å…ˆã«ã‚‚æŒ™ã’ãŸ xUnit Test Patterns ã«ãŠã„ã¦ã‚‚ç´¹ä»‹ã•ã‚Œã¦ãŠã‚Šã€ UI ã«é©ç”¨ã—ãŸãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦ `Humble Dialog` ã¨ã„ã†åå‰ãŒã¤ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã€‚

> we may benefit by using a Humble Object to move all of the controller and view-updating logic out of the framework-dependent object and into a testable object.

:::message
Meszaros, Gerard. xUnit Test Patterns: Refactoring Test Code (Addison-Wesley Signature Series (Fowler)). Pearson Education. Kindle ç‰ˆ. Chapter 26. ã‚ˆã‚Šå¼•ç”¨
:::

## Presenter ã‚’ã‚«ã‚¹ã‚¿ãƒ  Hook ã¨ã—ã¦å®Ÿè£…ã™ã‚‹

React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè‡ªä½“ã¯ç´ ç›´ã«è–„ãä½œã‚Šã€è¡¨ç¤ºç”¨ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ã‚¹ã‚¿ãƒ  Hook ã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã€‚ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢ã¨ã—ã¦ã¯å˜ç´”ã ã€‚

ã“ã®ã‚ˆã†ã«åˆ†é›¢ã™ã‚‹ã“ã¨ã§ã‚«ã‚¹ã‚¿ãƒ  Hook å˜ä½“ã®ãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã¨ãªã‚Šã€è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ†ã‚¹ãƒˆã—ã‚„ã™ããªã‚‹ã€‚

## å®Ÿè£…ä¾‹

```typescript
function usePresenter(props: Props) {
  return {
    labels: {
      postedAt: props.postedAt,
    },
    actions: {},
  };
}
```

# é–¢é€£

## Redux

## Container / Presenter ãƒ‘ã‚¿ãƒ¼ãƒ³

# ã¾ã¨ã‚

## Pros

## Cons
