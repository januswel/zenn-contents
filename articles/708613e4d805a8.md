---
title: "TypeScript ã§å¼•æ•°ã¾ã§å«ã‚ãŸé–¢æ•°å‘¼ã³å‡ºã—ã”ã¨ã« debounce ã—ãŸã„ï¼"
emoji: "ğŸˆ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [function, typescript]
published: true
publication_name: "beingish"
---

æ¬¡ã®ã‚ˆã†ãªé–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠã‘ã°ã‚ˆã„ã€‚

```typescript:debounceBasedOnArgs.ts
import type { DebounceSettings, DebouncedFunc } from 'lodash';
import debounce from 'lodash.debounce';
import memoize from 'lodash.memoize';

// eslint-disable-next-line @typescript-eslint/no-explicit-any
export function debounceBasedOnArgs<R, F extends (...args: any[]) => R>(
  fn: F,
  wait = 0,
  options: DebounceSettings = {}
): (...args: Parameters<F>) => ReturnType<F> | undefined {
  const debouncedAndMemoized = memoize<(...args: Parameters<F>) => DebouncedFunc<F>>(
    function debounced() {
      return debounce(fn, wait, options);
    },
    (...args: Parameters<F>) => JSON.stringify(args)
  );

  return function wrappedFunction(...args: Parameters<F>): ReturnType<F> | undefined {
    return debouncedAndMemoized(...args)(...args);
  };
}
```

ä½¿ã„æ–¹ã¯æ¬¡ã®ã‚ˆã†ã«ã€‚

```typescript
const logEvent = debounceBasedOnArgs(
  (eventName: string, parameters: Record<string, string>) => {
    gtag("event", eventName, parameters);
  },
  100
);

logEvent("tap_item", {
  name: "Anpanman",
});
logEvent("tap_item", {
  name: "Currypanman",
});
logEvent("tap_item", {
  name: "Shokupanman",
});
logEvent("tap_item", {
  name: "Anpanman",
});
```

ã“ã†ã™ã‚‹ã“ã¨ã§ `Anpanman` ã® `tap_item` ã‚¤ãƒ™ãƒ³ãƒˆã¯ä¸€åº¦ã—ã‹è¨˜éŒ²ã•ã‚Œãªã„ã‚ˆã†ã«ãªã‚‹ã€‚

# è§£èª¬

å…ƒãƒã‚¿ã¯[lodash ã® GitHub issue ã«ã‚ã£ãŸã“ã®ã‚³ãƒ¡ãƒ³ãƒˆ](https://github.com/lodash/lodash/issues/2403#issuecomment-1706130395) ã€‚

`memoize` é–¢æ•°ã®ç¬¬ 2 å¼•æ•°ã§ã‚ã‚‹ `resolver` ã«ã€å¼•æ•°ã‚’å…ƒã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªæ–‡å­—åˆ—ã‚’ä½œã‚‹ãŸã‚ã®é–¢æ•°ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã€‚ `memoize` ã¯å†…éƒ¨ã§å¼•æ•°ã¨é–¢æ•°ã®çµæœã‚’ãƒšã‚¢ã«ã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¦ã„ã‚‹ãŒã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ãã®éš›ã«ä½¿ã‚ã‚Œã‚‹å¼•æ•°ã¯ç¬¬ 1 å¼•æ•°ã®ã¿ã¨ãªã£ã¦ã„ã‚‹ã€‚ä»Šå›ã‚„ã‚ŠãŸã„ã“ã¨ã¨ã¯é•ã†ã®ã§ `resolver` ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã€‚ã»ã‹ã¯ç†è§£ã—ã‚„ã™ã„ã‚ˆã†ã€å‹å®šç¾©ã‚’å¤šå°‘ã„ã˜ã£ã¦ã„ã‚‹ã€‚
