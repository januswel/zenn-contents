---
title: "unified ã‚’ä½¿ã†å‰æº–å‚™"
emoji: "ğŸ¦¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [unified,AST,javascript]
published: true
---

ä»¥å‰ã€ [Markdown ãƒ™ãƒ¼ã‚¹ã® WYSIWYG ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã‚’ä½œã‚Šã¾ã—ãŸ](https://zenn.dev/januswel/scraps/03c7a93c2c1ed7)ãŒã€ã“ã“ã§ä½¿ã£ã¦ã„ã‚‹ [remark](https://github.com/remarkjs/remark) ã«ã¤ã„ã¦ä½•ã‚‚çŸ¥ã‚‰ãªã‹ã£ãŸã®ã§ã€èª¿ã¹ãŸçµæœã‚’ã¾ã¨ã‚ã¾ã™ã€‚

ãŒã€å…¨éƒ¨æ›¸ãã¨ã™ã”ã„é‡ã«ãªã‚‹ã®ã§ã€ã¡ã‚‡ã£ã¨ãšã¤ã‚ã‘ã¦æ›¸ãäºˆå®šã§ã™ã€‚ã¾ãšã¯ unified ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®å‰æº–å‚™ã®è¨˜äº‹ã§ã™ã€‚

## unified ã¨ã¯

remark ã«ã¤ã„ã¦èª¿ã¹ã¦ã„ãŸã®ã«ã„ã¤ã®é–“ã«ã‹ [unified](https://github.com/unifiedjs/unified) ã®è©±ã—ã«ãªã£ã¦ã„ãŸã€‚ä½•ã‚’è¨€ã£ã¦ã„ã‚‹ã‹ï¼ˆä»¥ä¸‹ç•¥ã€‚

èª¿æŸ»ã—ãŸçµæœã€ remark ã¯ unified ã¨ã„ã†ã‚‚ã£ã¨å¤§ããªæ çµ„ã¿ã®ä¸­ã® Markdown æ‹…å½“ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚ãªã®ã§ã€ unified ã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚

unified ã¯å¤§é›‘æŠŠã«è¨€ã†ã¨ã€ãƒ†ã‚­ã‚¹ãƒˆã¨æ§‹æ–‡æœ¨ã‚„ AST ã¨ AST ã‚’å¤‰æ›ã™ã‚‹ãŸã‚ã® JavaScript è£½ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ã“ã¨ã§ã™ã€‚ TypeScript ã§ã‚‚æ‰±ã†ã“ã¨ãŒå¯èƒ½ã§ã™ãŒã€æ…£ã‚Œãªã„ã¨ã¡ã‚‡ã£ã¨ã‚€ãšã‹ã—ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

## unified ã«ãŠã‘ã‚‹ç”¨èª

### æ§‹æ–‡æœ¨

è‡ªç„¶è¨€èªã‚’åè©ã‚„å‹•è©ãªã©ã€æ§‹æ–‡ã«ãã£ã¦è§£æã—ã¦æœ¨æ§‹é€ ã¨ã—ãŸã‚‚ã®ã§ã™ã€‚

### AST

æ—¥æœ¬èªã§ã¯æŠ½è±¡æ§‹æ–‡æœ¨ã¨è¨€ã„ã¾ã™ã€‚ **A**bstract **S**yntax **T**ree ã®é ­æ–‡å­—ã‚’å–ã£ã¦ AST ã§ã™ã€‚

ä¸€è¨€ã§ã„ã†ã¨æ§‹æ–‡æœ¨ã‹ã‚‰ã€æ–‡æ³•ã®ãŸã‚ã®è¨˜å·ã‚„åŠ©è©ãªã©ã€æ„å‘³ã®ãªã„éƒ¨åˆ†ã‚’é™¤ã„ãŸæœ¨æ§‹é€ ã‚’æŒ‡ã—ã¾ã™ã€‚å®Ÿä¾‹ã¨ã—ã¦ã¯ HTML ã«å¯¾å¿œã™ã‚‹ DOM ãŒã‚ã‹ã‚Šã‚„ã™ã„ã‹ã¨æ€ã„ã¾ã™ã€‚`<` ã‚„ `>` ãªã©ã‚¿ã‚°ã‚’è¡¨ã™æ–‡å­—ã¯ DOM ã§ã¯ä¿æŒã•ã‚Œã¾ã›ã‚“ã€‚

### unist

**uni**versal **s**yntax **t**ree ã®ã“ã¨ã§ã™ã€‚å¤ªå­—ã«ã—ã¦ã‚ã‚‹éƒ¨åˆ†ã‚’ã¤ãªã’ã¦ unist ã¨å‘¼ã¶ã¿ãŸã„ã§ã™ã€‚

[unist](https://github.com/syntax-tree/unist) ã«å®šç¾©ã‚„æ“ä½œã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¼ãŒã¾ã¨ã¾ã£ã¦ã„ã¾ã™ã€‚

unified ã®ä¸–ç•Œã§ã¯ã€ AST ã®ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹ã‚‚ã®ã®ã‚ˆã†ã§ã™ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘çš„ã«ã„ã†ã¨ã™ã¹ã¦ã® AST ã®è¦ªã¨ãªã‚‹ã‚‚ã®ã§ã™ã­ã€‚ãã®ãŸã‚ã€åŸºæœ¬çš„ã« AST ã‚’æ“ä½œã™ã‚‹ã¨ãã¯ unist ã¨ã—ã¦æ‰±ã†ã¨ä¾¿åˆ©ã§ã™ã€‚

### parser

![parser](https://storage.googleapis.com/zenn-user-upload/gvh6s0zm61c1k9pbxt9xu7bp07fz)

parser ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’è§£é‡ˆã—ã¦ã€ãã® parser ãŒè§£é‡ˆã§ãã‚‹æ–‡æ³•ã«æ²¿ã£ãŸ AST ã‚’ç”Ÿæˆã™ã‚‹ã‚‚ã®ã§ã™ã€‚

### compiler

![compiler](https://storage.googleapis.com/zenn-user-upload/zb0wdhcmus7hkswe4kgvr8892o0g)

compiler ã¯ parser ã®åå¯¾ã®å‹•ä½œã‚’ã—ã¾ã™ã€‚ AST ã‹ã‚‰ã€æ–‡æ³•ã«æ²¿ã£ã¦ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚

### transformer

![transformer](https://storage.googleapis.com/zenn-user-upload/r6rqgzh5ze0yzbs49xoxzs4wqv67)

transformer ã¯ AST é–“ã®å¤‰æ›ã‚’ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

## å¯¾å¿œã—ã¦ã„ã‚‹æ–‡æ³•

ã“ã“ã§ã¯ unfied ã§æ‰±ã†ã“ã¨ã®ã§ãã‚‹æ–‡æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

### Markdown

Markdown æ–‡æ³•ã®æ‹…å½“ã¨ã—ã¦ [remark](https://github.com/remarkjs/remark) ãŒã‚ã‚Šã¾ã™ã€‚

remark ã«ãŠã‘ã‚‹ parser ã¯ [remark-parse](https://github.com/remarkjs/remark/tree/main/packages/remark-parse) ã€ compiler ã¯ [remark-stringify](https://github.com/remarkjs/remark/tree/main/packages/remark-stringify) ã§ã™ã€‚

transformer ã¯è‰²ã€…ã‚ã‚Šã¾ã™ã€‚

 name           | descs
 ---------------|-----------------------------------------
 remark-rehype  | Markdown AST ã‹ã‚‰ HTML AST ã¸ã®å¤‰æ›
 remark-retext  | Markdown AST ã‹ã‚‰è‡ªç„¶è¨€èªã®æ§‹æ–‡æœ¨ã¸ã®å¤‰æ›
 remark-react   | Markdown AST ã‹ã‚‰ ReactElement ã¸ã®å¤‰æ›

ã¡ãªã¿ã« remark å†…éƒ¨ã®å‡¦ç†ã¯ [micromark](https://github.com/micromark/micromark) ã«ç§»è­²ã•ã‚Œã¦ã„ã¾ã™ã€‚ micromark ã‚‚è‰²ã€…ã§ãã‚‹ã‚ˆã†ãªã®ã§ã™ãŒã€åˆ¥ã®è¨˜äº‹ã§å–ã‚Šä¸Šã’ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

ã¾ãŸã€Markdown ã‚’è¡¨ã™ AST ã¯ **m**ark**d**own **ast** ã®å¤ªå­—éƒ¨åˆ†ã‚’ã¤ãªã’ã¦ mdast ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ã€‚[æ“ä½œç”¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª](https://github.com/syntax-tree/mdast)ã‚‚ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

### HTML

HTML ã‚’æ‹…å½“ã™ã‚‹ã®ã¯ [rehype](https://github.com/rehypejs/rehype) ã§ã™ã€‚

[reyype-parse](https://github.com/rehypejs/rehype/tree/main/packages/rehype-parse) ã€ [rehype-stringify](https://github.com/rehypejs/rehype/tree/main/packages/rehype-stringify) ãŒãã‚Œãã‚Œ parser ã¨ compiler ã§ã™ã€‚

HTML æ–‡æ³•ã«ãŠã‘ã‚‹ AST ã¯ hast ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ã€‚ **h**tml **ast** ã®ç•¥ã§ã™ã€‚æ“ä½œç”¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¼ã¯ [hast](https://github.com/syntax-tree/hast) ã§ã™ã€‚

### è‡ªç„¶è¨€èª

[retext](https://github.com/retextjs/retext) ãŒæ‹…å½“ã—ã¦ã„ã¾ã™ã€‚

ç¾åœ¨ã¯[è‹±èª](https://github.com/retextjs/retext/tree/HEAD/packages/retext-english)ã€[ã‚ªãƒ©ãƒ³ãƒ€èª](https://github.com/retextjs/retext/tree/main/packages/retext-dutch)ã€[ãƒ©ãƒ†ãƒ³æ–‡å­—ã®è‡ªç„¶è¨€èª](https://github.com/retextjs/retext/tree/HEAD/packages/retext-latin)ã«å¯¾å¿œã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚[çµµæ–‡å­—](https://github.com/retextjs/retext-emoji)ã‚‚æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚

## ãƒ—ãƒ©ã‚°ã‚¤ãƒ³

unified ã¯ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚ parser ã‚„ compiler ã‚‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã—ã¦æä¾›ã•ã‚Œã¦ãŠã‚Šã€ transformer ã¯è‡ªåˆ†ã§å¥½ããªã‚ˆã†ã«å®šç¾©ã—ã¦ä½¿ã†ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

## ã¾ã¨ã‚

unified ã¯ã‹ãªã‚Šå¤§æ›ã‹ã‚Šãªä»•çµ„ã¿ã ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚è¿·å­ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã€ã¾ãšå…¨ä½“æ„Ÿã¨ç”¨èªã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚

æ¬¡å›ã¯ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®å®šç¾©ã¨ä½¿ã„æ–¹ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚
