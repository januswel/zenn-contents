---
title: "VSCode Neovim ã§ gk / gj ã‚’ä½¿ã„ãŸã„"
emoji: "ğŸ«µ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["vscode", "neovim", "lua"]
published: true
---

## çµè«–

æ¬¡ã‚’ `init.lua` ãªã©ã«æ›¸ãã€‚

```lua
if vim.g.vscode then
  local vscode = require('vscode-neovim')
  local function moveCursor(to, select)
    return function()
      vscode.action('cursorMove', {
      args = {
        {
          to = to,
          by = 'wrappedLine',
          value = vim.v.count1,
          select = select
        },
      },
    })
    return '<Ignore>'
    end
  end

  vim.keymap.set('n', 'gk', moveCursor('up'), { expr = true })
  vim.keymap.set('n', 'gj', moveCursor('down'), { expr = true })

  vim.keymap.set('v', 'gk', moveCursor('up', true), { expr = true })
  vim.keymap.set('v', 'gj', moveCursor('down', true), { expr = true })
end
```

è¦‹ã¦ã®é€šã‚Šã€ lua ã‚’ä½¿ã£ã¦ [VSCode API](https://code.visualstudio.com/api/references/commands) ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹ã€‚

lua ã§ã®è¨­å®šã¯æ¬¡ã‚ãŸã‚Šã‚’å‚ç…§ã€‚

https://neovim.io/doc/user/lua-guide.html#lua-guide-mappings-set
https://github.com/vscode-neovim/vscode-neovim?tab=readme-ov-file#%EF%B8%8F-api

## ãªãœã“ã‚“ãªã“ã¨ãŒå¿…è¦ãªã®ã‹

[VSCode Neovim](https://github.com/vscode-neovim/vscode-neovim) ã¯ Neovim ã‚’ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ç”¨ã® language server ã¨ã—ã¦ä½¿ã†ãŸã‚ã€é«˜ã„ãƒ¬ãƒ™ãƒ«ã§ Vim ã«å¯„ã›ãŸæ“ä½œæ„Ÿã‚’ VSCode ä¸Šã§å†ç¾ã§ãã‚‹ã€‚

ãŒã€ VSCode å´ã®ä»•æ§˜ã®ãŸã‚ã‹ã€æŠ˜ã‚Šè¿”ã•ã‚ŒãŸè¡Œã«ãŠã‘ã‚‹è¦‹ãŸç›®é€šã‚Šã®ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•ã‚’ã™ã‚‹ãŸã‚ã®æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„ã€‚ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ¢ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã‚‚åŒæ§˜ã€‚

- [`gk`](https://neovim.io/doc/user/motion.html#gk)
- [`gj`](https://neovim.io/doc/user/motion.html#gj)
- [`g0`](https://neovim.io/doc/user/motion.html#g0)
- [`g^`](https://neovim.io/doc/user/motion.html#g%5E)
- [`g$`](https://neovim.io/doc/user/motion.html#g%24)

å†’é ­ã«å‡ºã—ãŸè¨­å®šã¯[æœ¬å®¶ issue ã§ç´¹ä»‹ã•ã‚Œã¦ã„ãŸã‚‚ã®](https://github.com/vscode-neovim/vscode-neovim/issues/576#issuecomment-1835799743)ã€‚

`g0` ã€ `g^` ã€ `g$` ã«ã¤ã„ã¦ã¯æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã§ãã‚‹ã€‚

```lua
  vim.keymap.set('n', 'g0', moveCursor('wrappedLineStart'), { expr = true })
  vim.keymap.set('n', 'g^', moveCursor('wrappedLineFirstNonWhitespaceCharacter'), { expr = true })
  vim.keymap.set('n', 'g$', moveCursor('wrappedLineEnd'), { expr = true })

  vim.keymap.set('v', 'g0', moveCursor('wrappedLineStart', true), { expr = true })
  vim.keymap.set('v', 'g^', moveCursor('wrappedLineFirstNonWhitespaceCharacter', true), { expr = true })
  vim.keymap.set('v', 'g$', moveCursor('wrappedLineEnd', true), { expr = true })
```

## ã¼ããŒã‹ã‚“ãŒãˆãŸã•ã„ãã‚‡ã†ã®ããƒ¼ã¾ã£ã´ã‚“ã

æ‰‹å…ƒã§ã¯ã“ã†ã„ã†æ„Ÿã˜ã«ã—ã¦ã„ã‚‹ã€‚

https://github.com/januswel/dotfiles/blob/master/.config/nvim/init.lua
